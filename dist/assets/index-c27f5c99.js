var b=Object.defineProperty;var W=(t,e,i)=>e in t?b(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var d=(t,e,i)=>(W(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function i(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(n){if(n.ep)return;n.ep=!0;const c=i(n);fetch(n.href,c)}})();const p=400,x=700,u=25,o={canvasWidth:x,canvasHeight:p,paddleHeight:10,paddleWidth:75,ballRadius:10,brickRowCount:Math.floor(x/u),brickColumnCount:Math.floor(p/u),brickWidth:u,brickHeight:u,brickPadding:0,brickOffsetTop:0,brickOffsetLeft:0};var l=(t=>(t.Ball="ball",t.Brick1="brick1",t.Brick2="brick2",t.Brick3="brick3",t))(l||{});class L{constructor(){d(this,"pool",new Map);d(this,"amountLoaded",0);Object.values(l).map(e=>this.pool.set(e,this.newImage(e)))}get(e){return this.pool.get(e)}isLoading(){return this.amountLoaded<this.pool.size}newImage(e){const i=new Image;return i.src="assets/images/"+e+".png",i.onload=()=>this.amountLoaded++,i}}class H{constructor(e){d(this,"imagePool",new L);d(this,"ctx");this.ctx=e}image(e){const[i,s]=e.center;return this.ctx.drawImage(this.imagePool.get(e.source),i-e.width/2,s-e.height/2,e.width,e.height),this}circle(e){const[i,s]=e.center;return this.ctx.beginPath(),this.ctx.arc(i,s,e.radius,0,Math.PI*2),this.ctx.fillStyle=e.color,this.ctx.fill(),this.ctx.closePath(),this}rect(e){const[i,s]=e.center;return this.ctx.beginPath(),this.ctx.rect(i-e.width/2,s-e.height/2,e.width,e.height),this.ctx.fillStyle=e.color,this.ctx.fill(),this.ctx.closePath(),this}text(e,i){return this.textWithArgs({pos:i,value:e})}title(e,i){return this.textWithArgs({pos:i,value:e,size:64})}textWithArgs(e){const[i,s]=e.pos,n=e.font?e.font:"Arial",c=e.size?e.size:16,h=e.color?e.color:"#0095DD";return this.ctx.font=c+"px "+n,this.ctx.fillStyle=h,this.ctx.fillText(e.value,i,s),this}}function C(t,e){for(var i=0;i<o.brickColumnCount;i++)for(var s=0;s<o.brickRowCount;s++)t.bricks[i][s].isVisible==!0&&e.image({source:l.Brick1,center:[t.bricks[i][s].x+o.brickWidth/2,t.bricks[i][s].y+o.brickHeight/2],width:o.brickWidth,height:o.brickHeight})}function A(t,e){e.clearRect(0,0,o.canvasWidth,o.canvasHeight);const i=new H(e);switch(t.end){case"won":i.title("Game Won",[o.canvasWidth/2-150,o.canvasHeight/2]);return;case"lost":i.title("Game Lost",[o.canvasWidth/2-150,o.canvasHeight/2]);return}C(t,i),t.balls.forEach(s=>{i.circle({center:[s.x,s.y],radius:o.ballRadius,color:"#0095DD"})}),i.rect({center:[t.paddle.x+o.paddleWidth/2,o.canvasHeight-o.paddleHeight/2],width:o.paddleWidth,height:o.paddleHeight,color:"#0095DD"}),i.text("Score: "+t.score,[8,20]),i.text("Lives: "+t.lives,[o.canvasWidth-65,20])}class g{constructor(){d(this,"pressed");d(this,"mousePos");d(this,"mouseDown");d(this,"clicked");this.pressed=new Set,this.mousePos=[0,0],this.mouseDown=!1,this.clicked=!1}mouseInArea(e){const[i,s]=this.mousePos,[n,c]=e.center,h=n-e.width/2,v=c-e.height/2,w=n+e.width/2,m=c+e.height/2;return h<=i&&i<=w&&v<=s&&s<=m}keyDownHandler(e){console.log(e.code),e.code=="ArrowRight"||e.code=="KeyD"?this.pressed.add("Right"):e.code=="ArrowLeft"||e.code=="KeyA"?this.pressed.add("Left"):e.code=="ArrowUp"||e.code=="KeyW"?this.pressed.add("Up"):(e.code=="ArrowDown"||e.code=="KeyS")&&this.pressed.add("Down")}keyUpHandler(e){e.code=="ArrowRight"||e.code=="KeyD"?this.pressed.delete("Right"):e.code=="ArrowLeft"||e.code=="KeyA"?this.pressed.delete("Left"):e.code=="ArrowUp"||e.code=="KeyW"?this.pressed.delete("Up"):(e.code=="ArrowDown"||e.code=="KeyS")&&this.pressed.delete("Down")}mouseMoveHandler(e){return i=>{var s=i.clientX-e.offsetLeft,n=i.clientY-e.offsetTop;s>0&&s<e.width&&n>0&&n<e.height&&(this.mousePos=[s,n]),s>0&&s<e.width}}}var f=(t=>(t.Bounce="bounce",t))(f||{});function P(){let t=[];for(var e=0;e<o.brickColumnCount;e++){t[e]=[];for(var i=0;i<o.brickRowCount;i++){var s=i*(o.brickWidth+o.brickPadding)+o.brickOffsetLeft,n=e*(o.brickHeight+o.brickPadding)+o.brickOffsetTop;t[e][i]={x:s,y:n,isVisible:!0}}}return{paddle:{x:(o.canvasWidth-o.paddleWidth)/2},bricks:t,score:0,lives:3,balls:[{dx:2,dy:-2,x:o.canvasWidth/2,y:o.canvasHeight-30}],end:void 0}}function D(t){t.balls.forEach(e=>{e.x=o.canvasWidth/2,e.y=o.canvasHeight-30,e.dx=2,e.dy=-2}),t.paddle.x=(o.canvasWidth-o.paddleWidth)/2}function R(t){t.end="lost"}function E(t){t.end="won"}function O(t,e){for(var i=0;i<o.brickColumnCount;i++)for(var s=0;s<o.brickRowCount;s++){var n=t.bricks[i][s];n.isVisible==!0&&t.balls.forEach(c=>{c.x>n.x&&c.x<n.x+o.brickWidth&&c.y>n.y&&c.y<n.y+o.brickHeight&&(c.dy=-c.dy,t.score++,e.play(f.Bounce),t.score==o.brickRowCount*o.brickColumnCount&&E(t))})}}function K(t){t.balls.forEach(e=>{(e.x+e.dx>o.canvasWidth-o.ballRadius||e.x+e.dx<o.ballRadius)&&(e.dx=-e.dx),e.y+e.dy<o.ballRadius?e.dy=-e.dy:e.y+e.dy>o.canvasHeight-o.ballRadius&&(e.x>t.paddle.x&&e.x<t.paddle.x+o.paddleWidth?e.dy=-e.dy:(t.lives--,t.lives?D(t):R(t))),e.x+=e.dx,e.y+=e.dy})}function B(t,e){t.pressed.size==0?e.paddle.x=t.mousePos[0]-o.paddleWidth/2:t.pressed.has("Right")&&e.paddle.x<o.canvasWidth-o.paddleWidth?e.paddle.x+=7:t.pressed.has("Left")&&e.paddle.x>0&&(e.paddle.x-=7)}function M(t,e){for(var i=0;i<o.brickColumnCount;i++)for(var s=0;s<o.brickRowCount;s++)e.mouseInArea({center:[t.bricks[i][s].x+o.brickWidth/2,t.bricks[i][s].y+o.brickHeight/2],width:o.brickWidth,height:o.brickHeight})&&e.clicked&&(t.bricks[i][s].isVisible=!t.bricks[i][s].isVisible)}function S(t){t.game.end||(B(t.control,t.game),O(t.game,t.sound),K(t.game),M(t.game,t.control))}class z{constructor(){d(this,"pool",new Map);d(this,"ctx",new AudioContext);d(this,"amountLoaded",0);Object.values(f).map(e=>this.pool.set(e,this.newAudio(e)))}newAudio(e){const i=new Audio;return this.ctx.createMediaElementSource(i).connect(this.ctx.destination),i.src="assets/sounds/"+e+".mp3",i.oncanplay=()=>this.amountLoaded++,i}play(e){this.ctx.state==="suspended"&&this.ctx.resume();const i=this.pool.get(e);i.load(),i.play()}}const I=document.querySelector("#app"),a=document.createElement("canvas");a.width=o.canvasWidth;a.height=o.canvasHeight;I.append(a);let y=P(),r=new g,U=new z;document.addEventListener("keydown",V,!1);document.addEventListener("keyup",X,!1);document.addEventListener("mousemove",r.mouseMoveHandler(a),!1);document.addEventListener("mousedown",()=>r.mouseDown=!0);document.addEventListener("mouseup",()=>r.mouseDown=!1);document.addEventListener("click",()=>r.clicked=!0);function V(t){r.keyDownHandler(t)}function X(t){r.keyUpHandler(t)}const Y=a.getContext("2d");function k(){S({control:r,game:y,sound:U}),A(y,Y),r.clicked=!1,requestAnimationFrame(k)}k();
