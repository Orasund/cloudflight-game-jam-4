var y=Object.defineProperty;var v=(e,t,o)=>t in e?y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var d=(e,t,o)=>(v(e,typeof t!="symbol"?t+"":t,o),o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(l){if(l.ep)return;l.ep=!0;const n=o(l);fetch(l.href,n)}})();const i={canvasWidth:700,canvasHeight:400,paddleHeight:10,paddleWidth:75,ballRadius:10,brickRowCount:11,brickColumnCount:4,brickWidth:50,brickHeight:50,brickPadding:10,brickOffsetTop:30,brickOffsetLeft:30};var p=(e=>(e.Ball="ball",e.Brick1="brick1",e.Brick2="brick2",e.Brick3="brick3",e))(p||{});class w{constructor(){d(this,"pool",new Map);d(this,"amountLoaded",0);Object.values(p).map(t=>this.pool.set(t,this.newImage(t)))}get(t){return this.pool.get(t)}isLoading(){return this.amountLoaded<this.pool.size}newImage(t){const o=new Image;return o.src="assets/images/"+t+".png",o.onload=()=>this.amountLoaded++,o}}class k{constructor(t){d(this,"imagePool",new w);d(this,"ctx");this.ctx=t}image(t){const[o,s]=t.center;return this.ctx.drawImage(this.imagePool.get(t.source),o-t.width/2,s-t.height/2,t.width,t.height),this}circle(t){const[o,s]=t.center;return this.ctx.beginPath(),this.ctx.arc(o,s,t.radius,0,Math.PI*2),this.ctx.fillStyle=t.color,this.ctx.fill(),this.ctx.closePath(),this}rect(t){const[o,s]=t.center;return this.ctx.beginPath(),this.ctx.rect(o-t.width/2,s-t.height/2,t.width,t.height),this.ctx.fillStyle=t.color,this.ctx.fill(),this.ctx.closePath(),this}text(t,o){return this.textWithArgs({pos:o,value:t})}title(t,o){return this.textWithArgs({pos:o,value:t,size:64})}textWithArgs(t){const[o,s]=t.pos,l=t.font?t.font:"Arial",n=t.size?t.size:16,c=t.color?t.color:"#0095DD";return this.ctx.font=n+"px "+l,this.ctx.fillStyle=c,this.ctx.fillText(t.value,o,s),this}}function W(e,t){for(var o=0;o<i.brickColumnCount;o++)for(var s=0;s<i.brickRowCount;s++)e.bricks[o][s].status==1&&t.image({source:p.Brick1,center:[e.bricks[o][s].x+i.brickWidth/2,e.bricks[o][s].y+i.brickHeight/2],width:i.brickWidth,height:i.brickHeight})}function H(e,t){t.clearRect(0,0,i.canvasWidth,i.canvasHeight);const o=new k(t);switch(e.end){case"won":o.title("Game Won",[i.canvasWidth/2-150,i.canvasHeight/2]);return;case"lost":o.title("Game Lost",[i.canvasWidth/2-150,i.canvasHeight/2]);return}W(e,o),o.circle({center:[e.ball.x,e.ball.y],radius:i.ballRadius,color:"#0095DD"}).rect({center:[e.paddle.x+i.paddleWidth/2,i.canvasHeight-i.paddleHeight/2],width:i.paddleWidth,height:i.paddleHeight,color:"#0095DD"}),o.text("Score: "+e.score,[8,20]),o.text("Lives: "+e.lives,[i.canvasWidth-65,20])}class L{constructor(){d(this,"pressed");d(this,"mousePos");this.pressed=new Set,this.mousePos=[0,0]}keyDownHandler(t){console.log(t.code),t.code=="ArrowRight"||t.code=="KeyD"?this.pressed.add("Right"):t.code=="ArrowLeft"||t.code=="KeyA"?this.pressed.add("Left"):t.code=="ArrowUp"||t.code=="KeyW"?this.pressed.add("Up"):(t.code=="ArrowDown"||t.code=="KeyS")&&this.pressed.add("Down")}keyUpHandler(t){t.code=="ArrowRight"||t.code=="KeyD"?this.pressed.delete("Right"):t.code=="ArrowLeft"||t.code=="KeyA"?this.pressed.delete("Left"):t.code=="ArrowUp"||t.code=="KeyW"?this.pressed.delete("Up"):(t.code=="ArrowDown"||t.code=="KeyS")&&this.pressed.delete("Down")}mouseMoveHandler(t){return o=>{var s=o.clientX-t.offsetLeft,l=o.clientY-t.offsetTop;s>0&&s<t.width&&l>0&&l<t.height&&(this.mousePos=[s,l]),s>0&&s<t.width}}}const h=new AudioContext,u=new Audio;u.src="assets/sounds/bounce.mp3";h.createMediaElementSource(u).connect(h.destination);function a(){h.state==="suspended"&&h.resume(),u.load(),u.play()}function C(){let e=[];for(var t=0;t<i.brickColumnCount;t++){e[t]=[];for(var o=0;o<i.brickRowCount;o++){var s=o*(i.brickWidth+i.brickPadding)+i.brickOffsetLeft,l=t*(i.brickHeight+i.brickPadding)+i.brickOffsetTop;e[t][o]={x:s,y:l,status:1}}}return{paddle:{x:(i.canvasWidth-i.paddleWidth)/2},bricks:e,score:0,lives:3,ball:{dx:2,dy:-2,x:i.canvasWidth/2,y:i.canvasHeight-30},end:void 0}}function P(e){e.ball.x=i.canvasWidth/2,e.ball.y=i.canvasHeight-30,e.ball.dx=2,e.ball.dy=-2,e.paddle.x=(i.canvasWidth-i.paddleWidth)/2}function A(e){e.end="lost"}function R(e){e.end="won"}function D(e){for(var t=0;t<i.brickColumnCount;t++)for(var o=0;o<i.brickRowCount;o++){var s=e.bricks[t][o];s.status==1&&e.ball.x>s.x&&e.ball.x<s.x+i.brickWidth&&e.ball.y>s.y&&e.ball.y<s.y+i.brickHeight&&(e.ball.dy=-e.ball.dy,s.status=0,e.score++,a(),e.score==i.brickRowCount*i.brickColumnCount&&R(e))}}function O(e){(e.ball.x+e.ball.dx>i.canvasWidth-i.ballRadius||e.ball.x+e.ball.dx<i.ballRadius)&&(e.ball.dx=-e.ball.dx,a()),e.ball.y+e.ball.dy<i.ballRadius?(e.ball.dy=-e.ball.dy,a()):e.ball.y+e.ball.dy>i.canvasHeight-i.ballRadius&&(e.ball.x>e.paddle.x&&e.ball.x<e.paddle.x+i.paddleWidth?(e.ball.dy=-e.ball.dy,a()):(e.lives--,e.lives?P(e):A(e))),e.ball.x+=e.ball.dx,e.ball.y+=e.ball.dy}function K(e,t){e.pressed.size==0?t.paddle.x=e.mousePos[0]-i.paddleWidth/2:e.pressed.has("Right")&&t.paddle.x<i.canvasWidth-i.paddleWidth?t.paddle.x+=7:e.pressed.has("Left")&&t.paddle.x>0&&(t.paddle.x-=7)}function B(e,t){t.end||(K(e,t),D(t),O(t))}const S=document.querySelector("#app"),r=document.createElement("canvas");r.width=i.canvasWidth;r.height=i.canvasHeight;S.append(r);let b=C(),f=new L;document.addEventListener("keydown",z,!1);document.addEventListener("keyup",E,!1);document.addEventListener("mousemove",f.mouseMoveHandler(r),!1);function z(e){f.keyDownHandler(e)}function E(e){f.keyUpHandler(e)}const M=r.getContext("2d");function x(){B(f,b),H(b,M),requestAnimationFrame(x)}x();
